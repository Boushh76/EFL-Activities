<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clarkson's Farm Escape Room</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #87CEEB 0%, #98FB98 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .escape-room {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            width: 90vw;
            max-width: 800px;
            min-height: 600px;
            padding: 30px;
            position: relative;
            overflow: hidden;
        }

        .room {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }

        .room.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .room-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .room-title {
            font-size: 2.5em;
            color: #2E8B57;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 10px;
        }

        .progress-bar {
            background: #ddd;
            border-radius: 10px;
            height: 20px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-fill {
            background: linear-gradient(90deg, #32CD32, #228B22);
            height: 100%;
            border-radius: 10px;
            transition: width 0.5s ease;
            width: 0%;
        }

        .keys-collected {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 20px 0;
        }

        .key {
            font-size: 2em;
            opacity: 0.3;
            transition: all 0.3s ease;
        }

        .key.collected {
            opacity: 1;
            animation: bounce 0.5s ease;
        }

        @keyframes bounce {
            0%, 20%, 60%, 100% { transform: translateY(0); }
            40% { transform: translateY(-10px); }
            80% { transform: translateY(-5px); }
        }

        /* Hangman Game Styles */
        .hangman-game {
            text-align: center;
        }

        .cow-drawing {
            font-family: monospace;
            font-size: 1.2em;
            line-height: 1.2;
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .word-display {
            font-size: 2em;
            letter-spacing: 10px;
            margin: 20px 0;
            color: #2E8B57;
            font-weight: bold;
        }

        .alphabet {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(40px, 1fr));
            gap: 10px;
            margin: 20px 0;
        }

        .letter-btn {
            padding: 10px;
            border: 2px solid #2E8B57;
            background: white;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .letter-btn:hover {
            background: #2E8B57;
            color: white;
        }

        .letter-btn:disabled {
            opacity: 0.3;
            cursor: not-allowed;
            background: #ccc;
        }

        /* Memory Game Styles */
        .memory-game {
            text-align: center;
        }

        .memory-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
            margin: 30px 0;
            max-width: 600px;
            margin: 30px auto;
        }

        .memory-card {
            aspect-ratio: 1;
            background: #2E8B57;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            font-weight: bold;
            text-align: center;
            padding: 10px;
            font-size: 0.9em;
        }

        .memory-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .memory-card.flipped {
            background: white;
            color: #2E8B57;
            border: 2px solid #2E8B57;
        }

        .memory-card.matched {
            background: #32CD32;
            color: white;
        }

        /* Fill the Field Game Styles */
        .fill-game {
            text-align: center;
        }

        .sentence {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-size: 1.2em;
        }

        .blank {
            display: inline-block;
            min-width: 100px;
            height: 30px;
            border-bottom: 2px solid #2E8B57;
            margin: 0 5px;
            position: relative;
        }

        .word-bank {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            margin: 20px 0;
        }

        .word-option {
            padding: 10px 15px;
            background: #2E8B57;
            color: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .word-option:hover {
            background: #228B22;
            transform: translateY(-2px);
        }

        .word-option.used {
            opacity: 0.3;
            cursor: not-allowed;
        }

        .btn {
            background: #2E8B57;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1.1em;
            font-weight: bold;
            transition: all 0.3s ease;
            margin: 10px;
        }

        .btn:hover {
            background: #228B22;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .success-message {
            background: #32CD32;
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2em;
            animation: celebration 0.5s ease;
        }

        @keyframes celebration {
            0% { transform: scale(0.8); opacity: 0; }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); opacity: 1; }
        }

        .hint {
            font-style: italic;
            color: #666;
            margin: 10px 0;
        }

        .vocab-box {
            background: #f9f9f9;
            border: 2px solid #2E8B57;
            border-radius: 15px;
            padding: 20px;
            margin: 30px 0;
            text-align: center;
        }

        .vocab-box h3 {
            color: #2E8B57;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .vocab-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 8px;
            text-align: center;
        }

        .vocab-grid span {
            background: white;
            padding: 8px 12px;
            border-radius: 20px;
            border: 1px solid #2E8B57;
            font-size: 0.9em;
            color: #2E8B57;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="escape-room">
        <!-- Main Menu -->
        <div id="menu" class="room active">
            <div class="room-header">
                <h1 class="room-title">üöú Clarkson's Farm Escape Room üêÑ</h1>
                <p>Welcome to Diddly Squat Farm! You're locked in and need to complete 3 challenges to escape!</p>
            </div>
            
            <div class="progress-bar">
                <div class="progress-fill" id="progress"></div>
            </div>
            
            <div class="keys-collected">
                <span class="key" id="key1">üóùÔ∏è</span>
                <span class="key" id="key2">üóùÔ∏è</span>
                <span class="key" id="key3">üóùÔ∏è</span>
            </div>
            
            <div class="vocab-box">
                <h3>üìö Word List</h3>
                <div class="vocab-grid">
                    <span>Biblical</span>
                    <span>Cut Corners</span>
                    <span>Make Hay While the Sun Shines</span>
                    <span>Fertilizer</span>
                    <span>Acres</span>
                    <span>Cultivate</span>
                    <span>Reservoir</span>
                    <span>Baffle</span>
                    <span>Yield</span>
                    <span>Banned</span>
                    <span>Havoc</span>
                    <span>Armageddon</span>
                    <span>Quagmire</span>
                    <span>Digger</span>
                    <span>Head of Sheep</span>
                </div>
            </div>
            
            <div style="text-align: center;">
                <h3>Your Challenges:</h3>
                <p>üêÑ <strong>Room 1:</strong> Save the Cow (Hangman)</p>
                <p>üß† <strong>Room 2:</strong> Memory Farm</p>
                <p>üìù <strong>Room 3:</strong> Fill the Field</p>
                <button class="btn" onclick="startGame()">Enter the Farm!</button>
            </div>
        </div>

        <!-- Room 1: Hangman -->
        <div id="room1" class="room">
            <div class="room-header">
                <h2 class="room-title">üêÑ Room 1: Save the Cow!</h2>
                <p class="hint">Guess the word before the cow appears completely!</p>
            </div>
            
            <div class="hangman-game">
                <div class="cow-drawing" id="cowDrawing"></div>
                <div class="word-display" id="wordDisplay"></div>
                <div class="alphabet" id="alphabet"></div>
                <button class="btn" id="newWordBtn" onclick="newHangmanWord()" style="display: none;">New Word</button>
                <button class="btn" id="room1Complete" onclick="completeRoom(1)" style="display: none;">Collect Key & Continue</button>
            </div>
        </div>

        <!-- Room 2: Memory Game -->
        <div id="room2" class="room">
            <div class="room-header">
                <h2 class="room-title">üß† Room 2: Memory Farm</h2>
                <p class="hint">Match the words with their meanings!</p>
            </div>
            
            <div class="memory-game">
                <div class="memory-grid" id="memoryGrid"></div>
                <button class="btn" id="room2Complete" onclick="completeRoom(2)" style="display: none;">Collect Key & Continue</button>
            </div>
        </div>

        <!-- Room 3: Fill the Field -->
        <div id="room3" class="room">
            <div class="room-header">
                <h2 class="room-title">üìù Room 3: Fill the Field</h2>
                <p class="hint">Complete the sentences with the correct words!</p>
            </div>
            
            <div class="fill-game">
                <div id="sentences"></div>
                <div class="word-bank" id="wordBank"></div>
                <button class="btn" id="checkAnswers" onclick="checkFillAnswers()">Check Answers</button>
                <button class="btn" id="room3Complete" onclick="completeRoom(3)" style="display: none;">Collect Final Key!</button>
            </div>
        </div>

        <!-- Victory Screen -->
        <div id="victory" class="room">
            <div class="room-header">
                <h1 class="room-title">üéâ CONGRATULATIONS! üéâ</h1>
                <div class="success-message">
                    <h2>You've Successfully Escaped Diddly Squat Farm!</h2>
                    <p>Jeremy would be proud! You've mastered all the farm vocabulary and completed every challenge.</p>
                    <div class="keys-collected">
                        <span class="key collected">üóùÔ∏è</span>
                        <span class="key collected">üóùÔ∏è</span>
                        <span class="key collected">üóùÔ∏è</span>
                    </div>
                </div>
                <button class="btn" onclick="resetGame()">Play Again</button>
            </div>
        </div>
    </div>

    <script>
        // Game state
        let currentRoom = 0;
        let keysCollected = 0;
        let gameData = {
            hangman: {
                words: ['BIBLICAL', 'FERTILIZER', 'ACRES', 'CULTIVATE', 'RESERVOIR', 'YIELD', 'HAVOC', 'QUAGMIRE'],
                currentWord: '',
                guessedLetters: [],
                wrongGuesses: 0,
                maxWrongs: 6,
                wordsCompleted: 0
            },
            memory: {
                cards: [
                    {type: 'word', content: 'CUT CORNERS', id: 1},
                    {type: 'definition', content: 'Do something poorly to save time/money', id: 1},
                    {type: 'word', content: 'MAKE HAY WHILE THE SUN SHINES', id: 2},
                    {type: 'definition', content: 'Take advantage of good conditions', id: 2},
                    {type: 'word', content: 'ARMAGEDDON', id: 3},
                    {type: 'definition', content: 'Complete chaos or destruction', id: 3},
                    {type: 'word', content: 'BAFFLE', id: 4},
                    {type: 'definition', content: 'Confuse completely', id: 4},
                    {type: 'word', content: 'BANNED', id: 5},
                    {type: 'definition', content: 'Prohibited or forbidden', id: 5},
                    {type: 'word', content: 'DIGGER', id: 6},
                    {type: 'definition', content: 'Machine for excavating', id: 6}
                ],
                flippedCards: [],
                matchedPairs: 0
            },
            fill: {
                sentences: [
                    {text: 'Don\'t ___ ___ when building the barn!', answers: ['CUT', 'CORNERS'], filled: [false, false]},
                    {text: 'The weather is perfect - ___ ___ while the ___ ___!', answers: ['MAKE', 'HAY', 'SUN', 'SHINES'], filled: [false, false, false, false]},
                    {text: 'We have 50 ___ of sheep in the field.', answers: ['HEAD'], filled: [false]}
                ],
                availableWords: ['CUT', 'CORNERS', 'MAKE', 'HAY', 'SUN', 'SHINES', 'HEAD'],
                usedWords: []
            }
        };

        // Cow drawing stages
        const cowStages = [
            '', // 0 wrong
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )', // 1 wrong - head with horns
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )\n   ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n   ‚îÇ     ‚îÇ', // 2 wrong - body
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )\n   ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n  ‚ï±‚îÇ     ‚îÇ', // 3 wrong - front leg
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )\n   ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n  ‚ï±‚îÇ     ‚îÇ‚ï≤', // 4 wrong - back leg
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )\n   ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n  ‚ï±‚îÇ  o  ‚îÇ‚ï≤\n     o o', // 5 wrong - udders
            '    ‚à©‚îÄ‚îÄ‚îÄ‚à©\n   (  ¬∞ ¬∞  )\n   ‚ï≠‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ïÆ\n  ‚ï±‚îÇ  o  ‚îÇ‚ï≤\n  üîî o o  ~~~\n   MOOO!' // 6 wrong - complete cow with bell and tail
        ];

        function startGame() {
            currentRoom = 1;
            showRoom('room1');
            initHangman();
        }

        function showRoom(roomId) {
            document.querySelectorAll('.room').forEach(room => room.classList.remove('active'));
            document.getElementById(roomId).classList.add('active');
        }

        function updateProgress() {
            const progress = (keysCollected / 3) * 100;
            document.getElementById('progress').style.width = progress + '%';
        }

        function collectKey(keyNumber) {
            document.getElementById(`key${keyNumber}`).classList.add('collected');
            keysCollected++;
            updateProgress();
        }

        function completeRoom(roomNumber) {
            collectKey(roomNumber);
            
            if (roomNumber === 1) {
                showRoom('room2');
                initMemory();
            } else if (roomNumber === 2) {
                showRoom('room3');
                initFill();
            } else if (roomNumber === 3) {
                showRoom('victory');
            }
        }

        // Hangman Game Functions
        function initHangman() {
            gameData.hangman.wordsCompleted = 0;
            newHangmanWord();
            createAlphabet();
        }

        function newHangmanWord() {
            const words = gameData.hangman.words;
            gameData.hangman.currentWord = words[Math.floor(Math.random() * words.length)];
            gameData.hangman.guessedLetters = [];
            gameData.hangman.wrongGuesses = 0;
            
            updateWordDisplay();
            updateCowDrawing();
            resetAlphabet();
            
            document.getElementById('newWordBtn').style.display = 'none';
            document.getElementById('room1Complete').style.display = 'none';
        }

        function createAlphabet() {
            const alphabet = document.getElementById('alphabet');
            alphabet.innerHTML = '';
            
            for (let i = 65; i <= 90; i++) {
                const letter = String.fromCharCode(i);
                const btn = document.createElement('button');
                btn.className = 'letter-btn';
                btn.textContent = letter;
                btn.onclick = () => guessLetter(letter);
                alphabet.appendChild(btn);
            }
        }

        function resetAlphabet() {
            document.querySelectorAll('.letter-btn').forEach(btn => {
                btn.disabled = false;
                btn.style.background = 'white';
                btn.style.color = 'black';
            });
        }

        function guessLetter(letter) {
            if (gameData.hangman.guessedLetters.includes(letter)) return;
            
            gameData.hangman.guessedLetters.push(letter);
            
            const btn = event.target;
            btn.disabled = true;
            
            if (gameData.hangman.currentWord.includes(letter)) {
                btn.style.background = '#32CD32';
                btn.style.color = 'white';
            } else {
                btn.style.background = '#FF6B6B';
                btn.style.color = 'white';
                gameData.hangman.wrongGuesses++;
                updateCowDrawing();
            }
            
            updateWordDisplay();
            checkHangmanWin();
        }

        function updateWordDisplay() {
            const word = gameData.hangman.currentWord;
            const guessed = gameData.hangman.guessedLetters;
            let display = '';
            
            for (let letter of word) {
                if (guessed.includes(letter)) {
                    display += letter + ' ';
                } else {
                    display += '_ ';
                }
            }
            
            document.getElementById('wordDisplay').textContent = display.trim();
        }

        function updateCowDrawing() {
            const stage = Math.min(gameData.hangman.wrongGuesses, cowStages.length - 1);
            document.getElementById('cowDrawing').innerHTML = '<pre>' + cowStages[stage] + '</pre>';
        }

        function checkHangmanWin() {
            const word = gameData.hangman.currentWord;
            const guessed = gameData.hangman.guessedLetters;
            const wordComplete = word.split('').every(letter => guessed.includes(letter));
            
            if (wordComplete) {
                gameData.hangman.wordsCompleted++;
                if (gameData.hangman.wordsCompleted >= 2) {
                    setTimeout(() => {
                        alert('Excellent! You\'ve saved enough cows!');
                        document.getElementById('room1Complete').style.display = 'inline-block';
                    }, 500);
                } else {
                    setTimeout(() => {
                        alert('Great! One more word to go!');
                        document.getElementById('newWordBtn').style.display = 'inline-block';
                    }, 500);
                }
            } else if (gameData.hangman.wrongGuesses >= gameData.hangman.maxWrongs) {
                setTimeout(() => {
                    alert('Oh no! The cow is complete. Try another word!');
                    document.getElementById('newWordBtn').style.display = 'inline-block';
                }, 500);
            }
        }

        // Memory Game Functions
        function initMemory() {
            const grid = document.getElementById('memoryGrid');
            grid.innerHTML = '';
            gameData.memory.flippedCards = [];
            gameData.memory.matchedPairs = 0;
            
            // Shuffle cards
            const shuffled = [...gameData.memory.cards].sort(() => Math.random() - 0.5);
            
            shuffled.forEach((card, index) => {
                const cardElement = document.createElement('div');
                cardElement.className = 'memory-card';
                cardElement.textContent = '?';
                cardElement.dataset.cardId = card.id;
                cardElement.dataset.content = card.content;
                cardElement.dataset.index = index;
                cardElement.onclick = () => flipCard(cardElement);
                grid.appendChild(cardElement);
            });
        }

        function flipCard(card) {
            if (card.classList.contains('flipped') || card.classList.contains('matched')) return;
            if (gameData.memory.flippedCards.length >= 2) return;
            
            card.classList.add('flipped');
            card.textContent = card.dataset.content;
            gameData.memory.flippedCards.push(card);
            
            if (gameData.memory.flippedCards.length === 2) {
                setTimeout(checkMemoryMatch, 1000);
            }
        }

        function checkMemoryMatch() {
            const [card1, card2] = gameData.memory.flippedCards;
            
            if (card1.dataset.cardId === card2.dataset.cardId) {
                card1.classList.add('matched');
                card2.classList.add('matched');
                gameData.memory.matchedPairs++;
                
                if (gameData.memory.matchedPairs === 6) {
                    setTimeout(() => {
                        alert('Perfect! You\'ve matched all the farm terms!');
                        document.getElementById('room2Complete').style.display = 'inline-block';
                    }, 500);
                }
            } else {
                card1.classList.remove('flipped');
                card2.classList.remove('flipped');
                card1.textContent = '?';
                card2.textContent = '?';
            }
            
            gameData.memory.flippedCards = [];
        }

        // Fill the Field Game Functions
        function initFill() {
            const sentencesDiv = document.getElementById('sentences');
            const wordBank = document.getElementById('wordBank');
            
            sentencesDiv.innerHTML = '';
            wordBank.innerHTML = '';
            
            // Create sentences with blanks
            gameData.fill.sentences.forEach((sentence, sentIndex) => {
                const sentenceDiv = document.createElement('div');
                sentenceDiv.className = 'sentence';
                
                let html = sentence.text;
                sentence.answers.forEach((answer, answerIndex) => {
                    const blankId = `blank_${sentIndex}_${answerIndex}`;
                    html = html.replace('___', `<span class="blank" id="${blankId}" onclick="selectBlank('${blankId}')"></span>`);
                });
                
                sentenceDiv.innerHTML = html;
                sentencesDiv.appendChild(sentenceDiv);
            });
            
            // Create word bank - shuffle the words so they appear randomly
            const shuffledWords = [...gameData.fill.availableWords].sort(() => Math.random() - 0.5);
            shuffledWords.forEach(word => {
                const wordDiv = document.createElement('div');
                wordDiv.className = 'word-option';
                wordDiv.textContent = word;
                wordDiv.onclick = () => selectWord(word, wordDiv);
                wordBank.appendChild(wordDiv);
            });
        }

        let selectedBlank = null;

        function selectBlank(blankId) {
            // Reset previous selection
            document.querySelectorAll('.blank').forEach(blank => {
                blank.style.backgroundColor = '';
            });
            
            selectedBlank = blankId;
            document.getElementById(blankId).style.backgroundColor = '#FFE4B5';
        }

        function selectWord(word, wordElement) {
            if (!selectedBlank || wordElement.classList.contains('used')) return;
            
            const blankElement = document.getElementById(selectedBlank);
            blankElement.textContent = word;
            blankElement.style.backgroundColor = '';
            
            wordElement.classList.add('used');
            gameData.fill.usedWords.push(word);
            
            selectedBlank = null;
        }

        function checkFillAnswers() {
            let allCorrect = true;
            
            gameData.fill.sentences.forEach((sentence, sentIndex) => {
                sentence.answers.forEach((correctAnswer, answerIndex) => {
                    const blankId = `blank_${sentIndex}_${answerIndex}`;
                    const blankElement = document.getElementById(blankId);
                    const userAnswer = blankElement.textContent.trim();
                    
                    if (userAnswer === correctAnswer) {
                        blankElement.style.color = '#32CD32';
                        blankElement.style.fontWeight = 'bold';
                    } else {
                        blankElement.style.color = '#FF6B6B';
                        blankElement.style.fontWeight = 'bold';
                        allCorrect = false;
                    }
                });
            });
            
            if (allCorrect) {
                setTimeout(() => {
                    alert('Outstanding! You\'ve completed all the sentences correctly!');
                    document.getElementById('room3Complete').style.display = 'inline-block';
                    document.getElementById('checkAnswers').style.display = 'none';
                }, 500);
            } else {
                alert('Some answers aren\'t quite right. Keep trying!');
            }
        }

        function resetGame() {
            currentRoom = 0;
            keysCollected = 0;
            gameData.hangman.wordsCompleted = 0;
            gameData.memory.matchedPairs = 0;
            gameData.fill.usedWords = [];
            
            // Reset keys display
            document.querySelectorAll('.key').forEach(key => key.classList.remove('collected'));
            updateProgress();
            
            showRoom('menu');
        }

        // Initialize
        updateProgress();
    </script>
</body>
</html>